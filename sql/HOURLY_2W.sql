SELECT CONVERT(CHAR(20), AA.DATE_ID, 'dd/MM/yyyy'), AA.HOUR_ID, AA.CELL_NAME, AA.BSC,

ISNULL(CAST(100*(1-[TDWNACC]/NULLIF([TDWNSCAN], 0)) AS DEC(19,2)), 0) AS [Availability],
ISNULL(CAST(100*([ITFUSIB4]+[ITFUSIB5]+[ITHUSIB5]+[ITHUSIB4]+ [ITFOSIB4]+[ITFOSIB5]+[ITHOSIB5]+[ITHOSIB4])/NULLIF([ITHUSIB5]+[ITHUSIB4]+[ITHUSIB3]+[ITHUSIB2]+[ITHUSIB1]+[ITFUSIB5]+[ITFUSIB4]+[ITFUSIB3]+[ITFUSIB2]+[ITFUSIB1]+ [ITHOSIB5]+[ITHOSIB4]+[ITHOSIB3]+[ITHOSIB2]+[ITHOSIB1]+[ITFOSIB5]+[ITFOSIB4]+[ITFOSIB3]+[ITFOSIB2]+[ITFOSIB1], 0) AS DEC(19,2)), 0) AS [Interference_UL_ICM_Band4_Band5],
ISNULL(CAST(100*(1-([CCONGS]/NULLIF([CCALLS], 0))) * (1-([CNDROP]/NULLIF([CMSESTAB], 0)))*(([TFCASSALL] +[TFCASSALLSUB] +[THCASSALL] +[THCASSALLSUB])/NULLIF([TASSALL], 0)) AS DEC(19,2)), 0) AS [Call_Setup_Success_Rate],
ISNULL(CAST(100*(CNDROP-CNRELCONG)/NULLIF(CMSESTAB, 0) AS DEC(19,2)), 0) AS [SDCCH_Drop_Rate],
ISNULL(CAST(100*(TFNDROP+TFNDROPSUB+THNDROP+THNDROPSUB)/NULLIF(TFNDROP+TFNDROPSUB+THNDROP+THNDROPSUB+DISNORM, 0) AS DEC(19,2)), 0) AS [Call_Drop_Rate],
ISNULL(CAST(100*(([SUMOHOSUCC]+[SUMEOHSUCC])/NULLIF([SUMOHOATT]+[SUMEOHATT], 0)) AS DEC(19,2)), 0) AS [HO_Success_Rate],
CAST([SUMEOHATT] AS DEC(19,2)) AS [HO_attempts],
ISNULL(CAST(100*([HOVERSUCUTRAN_]-[HORTTOCHUTRAN_])/NULLIF([HOVERCNTUTRAN_], 0) AS DEC(19,2)), 0) AS [HO_UTRAN_Success_Rate],
ISNULL([HOVERCNTUTRAN_], 0) AS [HO_Utran_Attempts],
ISNULL([HOVERSUCUTRAN_], 0) AS [HO_Utran_Success],
ISNULL([HORTTOCHUTRAN_], 0) AS [HO_Utran_Channel],
ISNULL(CAST((100*([LDISRR]+[LDISOTH]+[LDISTFI]+[FLUDISC]+[IAULREL]+[OTHULREL]+[PREJOTH]+[PREJTFI]+[PREEMPTULREL])/NULLIF([DLBGEGPFC]+[DLBGGPFC]+[ULBGEGPFC]+[ULBGGPFC], 0)) AS DEC(19,2)), 0) AS [TbfDrop_Rate],
ISNULL(CAST((TFTRALACC / NULLIF(TFNSCAN, 0) + THTRALACC / NULLIF(THNSCAN, 0)) AS DEC(19,2)), 0) AS [Voice_Traffic],
ISNULL(CAST((([DLBGEGDATA]+[DLBGGDATA])/8/1024 + ([ULBGEGDATA]+[ULBGGDATA])/8/1024) AS DEC(19,2)), 0) AS [Traffic_Mb],
ISNULL(CAST((([DLBGEGTHR]+[DLTHP1EGTHR]+[DLTHP2EGTHR]+[DLTHP3EGTHR]) / NULLIF([DLBGEGDATA]+[DLTHP1EGDATA]+[DLTHP2EGDATA]+[DLTHP3EGDATA], 0)) AS DEC(19,2)), 0) AS [DL_EGRPS_Throughput],
ISNULL(CAST((([ULBGEGTHR]+[ULTHP1EGTHR]+[ULTHP2EGTHR]+[ULTHP3EGTHR]) / NULLIF([ULBGEGDATA]+[ULTHP1EGDATA]+[ULTHP2EGDATA]+[ULTHP3EGDATA], 0)) AS DEC(19,2)), 0) AS [UL_EGRPS_Throughput],
ISNULL(CAST(100*(1-([RAACCFA]/NULLIF(([CNROCNT]+[RAACCFA]+[PDRAC]), 0))) AS DEC(19,2)), 0) AS [Random_Access_Success_Rate],
ISNULL(CAST(100 * ([SUMOHOREV] + [SUMOHOREV]) / NULLIF(([SUMEOHATT] + [SUMEOHATT]), 0) AS DEC(19,2)), 0) AS [HO_Reversion],
ISNULL(CAST(100 * (CDISSS + CDISSSSUB) / NULLIF(CNDROP, 0) AS DEC(19,2)), 0) AS [SDCCH_Drop_Reason_Low_SS],
ISNULL(CAST(100 * (CDISQA + CDISQASUB) / NULLIF(CNDROP, 0) AS DEC(19,2)), 0) AS [SDCCH_Drop_Reason_Quality],
ISNULL(CAST(100 * (CDISTA / NULLIF(CNDROP, 0)) AS DEC(19,2)), 0) AS SDCCH_Drop_Reason_Excessive_TA,
ISNULL(CAST(100 * (CNDROP- ((CDISSS+ CDISSSSUB)+ (CDISQA+ CDISQASUB)+ CDISTA))/ NULLIF(CNDROP, 0) AS DEC(19,2)), 0) AS [SDCCH_Drop_Reason_Other],
ISNULL(CAST(100 * (CNRELCONG / NULLIF((CMSESTAB-CCHHOSUC), 0)) AS DEC(19,2)), 0) AS [SDCCH_Congest],
ISNULL(CAST(100 * ((TFDISSDL+ THDISSDL+ TFDISSDLSUB+ THDISSDLSUB)+ (TFDISSUL+ THDISSUL+ TFDISSULSUB+ THDISSULSUB)+ (TFDISSBL+ THDISSBL+ TFDISSBLSUB+ THDISSBLSUB))/ NULLIF((TFNDROP+ THNDROP+ TFNDROPSUB+ THNDROPSUB), 0) AS DEC(19,2)), 0) AS [TCH_Drop_Reason_Low_SS],
ISNULL(CAST(100 * ((TFDISQADL+ THDISQADL+ TFDISQADLSUB+ THDISQADLSUB)+ (TFDISQAUL+ THDISQAUL+ TFDISQAULSUB+ THDISQAULSUB)+ (TFDISQABL+ THDISQABL+ TFDISQABLSUB+ THDISQABLSUB))/ NULLIF((TFNDROP+ THNDROP+ TFNDROPSUB+ THNDROPSUB), 0) AS DEC(19,2)), 0) AS [TCH_Drop_Reason_Bad_Quality],
ISNULL(CAST(100 * (TFSUDLOS+ THSUDLOS+ TFSUDLOSSUB+ THSUDLOSSUB)/ NULLIF((TFNDROP+ THNDROP+ TFNDROPSUB+ THNDROPSUB), 0) AS DEC(19,2)), 0) AS [TCH_Drop_Reason_Suddenly_Lost_Connection],
ISNULL(CAST(100 * (TFDISTA+ THDISTA)/ NULLIF((TFNDROP+ THNDROP+ TFNDROPSUB+ THNDROPSUB), 0) AS DEC(19,2)), 0) AS [TCH_Drop_Reason_Excessive_TA],
ISNULL(CAST(100 * ((TFNDROP+ THNDROP+ TFNDROPSUB+ THNDROPSUB)- ((TFDISSDL+ THDISSDL+ TFDISSDLSUB+ THDISSDLSUB)+ (TFDISSUL+ THDISSUL+ TFDISSULSUB+ THDISSULSUB)+ (TFDISSBL+ THDISSBL+ TFDISSBLSUB+ THDISSBLSUB)+ (TFDISQADL+ THDISQADL+ TFDISQADLSUB+ THDISQADLSUB)+ (TFDISQAUL+ THDISQAUL+ TFDISQAULSUB+ THDISQAULSUB)+ (TFDISQABL+ THDISQABL+ TFDISQABLSUB+ THDISQABLSUB)+ (TFDISTA+ THDISTA)+ (TFSUDLOS+ THSUDLOS+ TFSUDLOSSUB+ THSUDLOSSUB)))/ NULLIF((TFNDROP+ THNDROP+ TFNDROPSUB+ THNDROPSUB), 0) AS DEC(19,2)), 0) AS [TCH_Drop_Reason_Other]

FROM
(SELECT DATE_ID, HOUR_ID, CELL_NAME, BSC,
cast(IFNULL(SUM(CLSDCCH_CAVAACC),0,SUM(CLSDCCH_CAVAACC)) as dec(19,5)) AS CAVAACC,
cast(IFNULL(sum(cellcchho_cchhosuc),0,sum(cellcchho_cchhosuc)) as dec(19,5)) AS CCHHOSUC,
cast(IFNULL(AVG(CLSDCCH_CAVASCAN),0,AVG(CLSDCCH_CAVASCAN)) as dec(19,5)) AS CAVASCAN,
cast(IFNULL(SUM(CLSDCCH_CCALLS),0,SUM(CLSDCCH_CCALLS)) as dec(19,5)) AS CCALLS,
cast(IFNULL(SUM(CLSDCCH_CCONGS),0,SUM(CLSDCCH_CCONGS)) as dec(19,5)) AS CCONGS,
cast(IFNULL(SUM(CELLCCHDR_CDISQA),0,SUM(CELLCCHDR_CDISQA)) as dec(19,5)) AS CDISQA,
cast(IFNULL(SUM(CELLCCHDR_CDISQASUB),0,SUM(CELLCCHDR_CDISQASUB)) as dec(19,5)) AS CDISQASUB,
cast(IFNULL(SUM(CELLCCHDR_CDISSS),0,SUM(CELLCCHDR_CDISSS)) as dec(19,5)) AS CDISSS,
cast(IFNULL(SUM(CELLCCHDR_CDISSSSUB),0,SUM(CELLCCHDR_CDISSSSUB)) as dec(19,5)) AS CDISSSSUB,
cast(IFNULL(SUM(CELLCCHDR_CDISTA),0,SUM(CELLCCHDR_CDISTA)) as dec(19,5)) AS CDISTA,
cast(IFNULL(SUM(CLSDCCH_CESTIMMASS),0,SUM(CLSDCCH_CESTIMMASS)) as dec(19,5)) AS CESTIMMASS,
cast(IFNULL(SUM(CLSDCCH_CMSESTAB),0,SUM(CLSDCCH_CMSESTAB)) as dec(19,5)) AS CMSESTAB,
cast(IFNULL(SUM(CLSDCCH_CNDROP),0,SUM(CLSDCCH_CNDROP)) as dec(19,5)) AS CNDROP,
cast(IFNULL(SUM(CLSDCCH_CNRELCONG),0,SUM(CLSDCCH_CNRELCONG)) as dec(19,5)) AS CNRELCONG,
cast(IFNULL(SUM(RANDOMACC_CNROCNT),0,SUM(RANDOMACC_CNROCNT)) as dec(19,5)) AS CNROCNT,
cast(IFNULL(AVG(CLSDCCH_CNSCAN),0,AVG(CLSDCCH_CNSCAN)) as dec(19,5)) AS CNSCAN,
cast(IFNULL(SUM(CLSDCCH_CNUCHCNT),0,SUM(CLSDCCH_CNUCHCNT)) as dec(19,5)) AS CNUCHCNT,
cast(IFNULL(SUM(CLSDCCH_CTRALACC),0,SUM(CLSDCCH_CTRALACC)) as dec(19,5)) AS CTRALACC,
cast(IFNULL(SUM(CELEVENTD_DISNORM),0,SUM(CELEVENTD_DISNORM)) as dec(19,5)) AS DISNORM,
cast(IFNULL(SUM(IDLEOTCHF_ITFOSIB1),0,SUM(IDLEOTCHF_ITFOSIB1)) as dec(19,5)) AS ITFOSIB1,
cast(IFNULL(SUM(IDLEOTCHF_ITFOSIB2),0,SUM(IDLEOTCHF_ITFOSIB2)) as dec(19,5)) AS ITFOSIB2,
cast(IFNULL(SUM(IDLEOTCHF_ITFOSIB3),0,SUM(IDLEOTCHF_ITFOSIB3)) as dec(19,5)) AS ITFOSIB3,
cast(IFNULL(SUM(IDLEOTCHF_ITFOSIB4),0,SUM(IDLEOTCHF_ITFOSIB4)) as dec(19,5)) AS ITFOSIB4,
cast(IFNULL(SUM(IDLEOTCHF_ITFOSIB5),0,SUM(IDLEOTCHF_ITFOSIB5)) as dec(19,5)) AS ITFOSIB5,
cast(IFNULL(SUM(IDLEUTCHF_ITFUSIB1),0,SUM(IDLEUTCHF_ITFUSIB1)) as dec(19,5)) AS ITFUSIB1,
cast(IFNULL(SUM(IDLEUTCHF_ITFUSIB2),0,SUM(IDLEUTCHF_ITFUSIB2)) as dec(19,5)) AS ITFUSIB2,
cast(IFNULL(SUM(IDLEUTCHF_ITFUSIB3),0,SUM(IDLEUTCHF_ITFUSIB3)) as dec(19,5)) AS ITFUSIB3,
cast(IFNULL(SUM(IDLEUTCHF_ITFUSIB4),0,SUM(IDLEUTCHF_ITFUSIB4)) as dec(19,5)) AS ITFUSIB4,
cast(IFNULL(SUM(IDLEUTCHF_ITFUSIB5),0,SUM(IDLEUTCHF_ITFUSIB5)) as dec(19,5)) AS ITFUSIB5,
cast(IFNULL(SUM(IDLEOTCHH_ITHOSIB1),0,SUM(IDLEOTCHH_ITHOSIB1)) as dec(19,5)) AS ITHOSIB1,
cast(IFNULL(SUM(IDLEOTCHH_ITHOSIB2),0,SUM(IDLEOTCHH_ITHOSIB2)) as dec(19,5)) AS ITHOSIB2,
cast(IFNULL(SUM(IDLEOTCHH_ITHOSIB3),0,SUM(IDLEOTCHH_ITHOSIB3)) as dec(19,5)) AS ITHOSIB3,
cast(IFNULL(SUM(IDLEOTCHH_ITHOSIB4),0,SUM(IDLEOTCHH_ITHOSIB4)) as dec(19,5)) AS ITHOSIB4,
cast(IFNULL(SUM(IDLEOTCHH_ITHOSIB5),0,SUM(IDLEOTCHH_ITHOSIB5)) as dec(19,5)) AS ITHOSIB5,
cast(IFNULL(SUM(IDLEUTCHH_ITHUSIB1),0,SUM(IDLEUTCHH_ITHUSIB1)) as dec(19,5)) AS ITHUSIB1,
cast(IFNULL(SUM(IDLEUTCHH_ITHUSIB2),0,SUM(IDLEUTCHH_ITHUSIB2)) as dec(19,5)) AS ITHUSIB2,
cast(IFNULL(SUM(IDLEUTCHH_ITHUSIB3),0,SUM(IDLEUTCHH_ITHUSIB3)) as dec(19,5)) AS ITHUSIB3,
cast(IFNULL(SUM(IDLEUTCHH_ITHUSIB4),0,SUM(IDLEUTCHH_ITHUSIB4)) as dec(19,5)) AS ITHUSIB4,
cast(IFNULL(SUM(IDLEUTCHH_ITHUSIB5),0,SUM(IDLEUTCHH_ITHUSIB5)) as dec(19,5)) AS ITHUSIB5,
cast(IFNULL(SUM(CLRXQUAL_QUAL00DL),0,SUM(CLRXQUAL_QUAL00DL)) as dec(19,5)) AS QUAL00DL,
cast(IFNULL(SUM(CLRXQUAL_QUAL00UL),0,SUM(CLRXQUAL_QUAL00UL)) as dec(19,5)) AS QUAL00UL,
cast(IFNULL(SUM(CLRXQUAL_QUAL10DL),0,SUM(CLRXQUAL_QUAL10DL)) as dec(19,5)) AS QUAL10DL,
cast(IFNULL(SUM(CLRXQUAL_QUAL10UL),0,SUM(CLRXQUAL_QUAL10UL)) as dec(19,5)) AS QUAL10UL,
cast(IFNULL(SUM(CLRXQUAL_QUAL20DL),0,SUM(CLRXQUAL_QUAL20DL)) as dec(19,5)) AS QUAL20DL,
cast(IFNULL(SUM(CLRXQUAL_QUAL20UL),0,SUM(CLRXQUAL_QUAL20UL)) as dec(19,5)) AS QUAL20UL,
cast(IFNULL(SUM(CLRXQUAL_QUAL30DL),0,SUM(CLRXQUAL_QUAL30DL)) as dec(19,5)) AS QUAL30DL,
cast(IFNULL(SUM(CLRXQUAL_QUAL30UL),0,SUM(CLRXQUAL_QUAL30UL)) as dec(19,5)) AS QUAL30UL,
cast(IFNULL(SUM(CLRXQUAL_QUAL40DL),0,SUM(CLRXQUAL_QUAL40DL)) as dec(19,5)) AS QUAL40DL,
cast(IFNULL(SUM(CLRXQUAL_QUAL40UL),0,SUM(CLRXQUAL_QUAL40UL)) as dec(19,5)) AS QUAL40UL,
cast(IFNULL(SUM(CLRXQUAL_QUAL50DL),0,SUM(CLRXQUAL_QUAL50DL)) as dec(19,5)) AS QUAL50DL,
cast(IFNULL(SUM(CLRXQUAL_QUAL50UL),0,SUM(CLRXQUAL_QUAL50UL)) as dec(19,5)) AS QUAL50UL,
cast(IFNULL(SUM(CLRXQUAL_QUAL60DL),0,SUM(CLRXQUAL_QUAL60DL)) as dec(19,5)) AS QUAL60DL,
cast(IFNULL(SUM(CLRXQUAL_QUAL60UL),0,SUM(CLRXQUAL_QUAL60UL)) as dec(19,5)) AS QUAL60UL,
cast(IFNULL(SUM(CLRXQUAL_QUAL70DL),0,SUM(CLRXQUAL_QUAL70DL)) as dec(19,5)) AS QUAL70DL,
cast(IFNULL(SUM(CLRXQUAL_QUAL70UL),0,SUM(CLRXQUAL_QUAL70UL)) as dec(19,5)) AS QUAL70UL,
cast(IFNULL(SUM(RANDOMACC_RAACCFA),0,SUM(RANDOMACC_RAACCFA)) as dec(19,5)) AS RAACCFA,
cast(IFNULL(SUM(RANDOMACC_RAANPAG),0,SUM(RANDOMACC_RAANPAG)) as dec(19,5)) AS RAANPAG,
cast(IFNULL(SUM(RNDACCEXT_RAAPAG1),0,SUM(RNDACCEXT_RAAPAG1)) as dec(19,5)) AS RAAPAG1,
cast(IFNULL(SUM(RNDACCEXT_RAAPAG2),0,SUM(RNDACCEXT_RAAPAG2)) as dec(19,5)) AS RAAPAG2,
cast(IFNULL(SUM(RNDACCEXT_RAAPOPS),0,SUM(RNDACCEXT_RAAPOPS)) as dec(19,5)) AS RAAPOPS,
cast(IFNULL(SUM(RNDACCEXT_RACALR1),0,SUM(RNDACCEXT_RACALR1)) as dec(19,5)) AS RACALR1,
cast(IFNULL(SUM(RNDACCEXT_RACALR2),0,SUM(RNDACCEXT_RACALR2)) as dec(19,5)) AS RACALR2,
cast(IFNULL(SUM(RANDOMACC_RACALRE),0,SUM(RANDOMACC_RACALRE)) as dec(19,5)) AS RACALRE,
cast(IFNULL(SUM(RANDOMACC_RAEMCAL),0,SUM(RANDOMACC_RAEMCAL)) as dec(19,5)) AS RAEMCAL,
cast(IFNULL(SUM(RNDACCEXT_RAORDAT),0,SUM(RNDACCEXT_RAORDAT)) as dec(19,5)) AS RAORDAT,
cast(IFNULL(SUM(RNDACCEXT_RAORSPE),0,SUM(RNDACCEXT_RAORSPE)) as dec(19,5)) AS RAORSPE,
cast(IFNULL(SUM(RANDOMACC_RAOSREQ),0,SUM(RANDOMACC_RAOSREQ)) as dec(19,5)) AS RAOSREQ,
cast(IFNULL(SUM(RANDOMACC_RAOTHER),0,SUM(RANDOMACC_RAOTHER)) as dec(19,5)) AS RAOTHER,
cast(IFNULL(SUM(RANDOMACC_RATRHFAANPAG),0,SUM(RANDOMACC_RATRHFAANPAG)) as dec(19,5)) AS RATRHFAANPAG,
cast(IFNULL(SUM(RANDOMACC_RATRHFAEMCAL),0,SUM(RANDOMACC_RATRHFAEMCAL)) as dec(19,5)) AS RATRHFAEMCAL,
cast(IFNULL(SUM(RANDOMACC_RATRHFAOTHER),0,SUM(RANDOMACC_RATRHFAOTHER)) as dec(19,5)) AS RATRHFAOTHER,
cast(IFNULL(SUM(RANDOMACC_RATRHFAREG),0,SUM(RANDOMACC_RATRHFAREG)) as dec(19,5)) AS RATRHFAREG,
cast(IFNULL(SUM(CLTCH_TASSALL),0,SUM(CLTCH_TASSALL)) as dec(19,5)) AS TASSALL,
cast(IFNULL(SUM(CLTCH_TAVAACC),0,SUM(CLTCH_TAVAACC)) as dec(19,5)) AS TAVAACC,
cast(IFNULL(AVG(CLTCH_TAVASCAN),0,AVG(CLTCH_TAVASCAN)) as dec(19,5)) AS TAVASCAN,
cast(IFNULL(SUM(CLTCH_TCASSALL),0,SUM(CLTCH_TCASSALL)) as dec(19,5)) AS TCASSALL,
cast(IFNULL(SUM(DOWNTIME_TDWNACC),0,SUM(DOWNTIME_TDWNACC)) as dec(19,5)) AS TDWNACC,
cast(IFNULL(SUM(DOWNTIME_TDWNSCAN),0,SUM(DOWNTIME_TDWNSCAN)) as dec(19,5)) AS TDWNSCAN,
cast(IFNULL(SUM(CELTCHF_TFCASSALL),0,SUM(CELTCHF_TFCASSALL)) as dec(19,5)) AS TFCASSALL,
cast(IFNULL(SUM(CELTCHF_TFCASSALLSUB),0,SUM(CELTCHF_TFCASSALLSUB)) as dec(19,5)) AS TFCASSALLSUB,
cast(IFNULL(SUM(CLTCHDRF_TFDISQABL),0,SUM(CLTCHDRF_TFDISQABL)) as dec(19,5)) AS TFDISQABL,
cast(IFNULL(SUM(CLTCHDRF_TFDISQABLSUB),0,SUM(CLTCHDRF_TFDISQABLSUB)) as dec(19,5)) AS TFDISQABLSUB,
cast(IFNULL(SUM(CLTCHDRF_TFDISQADL),0,SUM(CLTCHDRF_TFDISQADL)) as dec(19,5)) AS TFDISQADL,
cast(IFNULL(SUM(CLTCHDRF_TFDISQADLSUB),0,SUM(CLTCHDRF_TFDISQADLSUB)) as dec(19,5)) AS TFDISQADLSUB,
cast(IFNULL(SUM(CLTCHDRF_TFDISQAUL),0,SUM(CLTCHDRF_TFDISQAUL)) as dec(19,5)) AS TFDISQAUL,
cast(IFNULL(SUM(CLTCHDRF_TFDISQAULSUB),0,SUM(CLTCHDRF_TFDISQAULSUB)) as dec(19,5)) AS TFDISQAULSUB,
cast(IFNULL(SUM(CLTCHDRF_TFDISSBL),0,SUM(CLTCHDRF_TFDISSBL)) as dec(19,5)) AS TFDISSBL,
cast(IFNULL(SUM(CLTCHDRF_TFDISSBLSUB),0,SUM(CLTCHDRF_TFDISSBLSUB)) as dec(19,5)) AS TFDISSBLSUB,
cast(IFNULL(SUM(CLTCHDRF_TFDISSDL),0,SUM(CLTCHDRF_TFDISSDL)) as dec(19,5)) AS TFDISSDL,
cast(IFNULL(SUM(CLTCHDRF_TFDISSDLSUB),0,SUM(CLTCHDRF_TFDISSDLSUB)) as dec(19,5)) AS TFDISSDLSUB,
cast(IFNULL(SUM(CLTCHDRF_TFDISSUL),0,SUM(CLTCHDRF_TFDISSUL)) as dec(19,5)) AS TFDISSUL,
cast(IFNULL(SUM(CLTCHDRF_TFDISSULSUB),0,SUM(CLTCHDRF_TFDISSULSUB)) as dec(19,5)) AS TFDISSULSUB,
cast(IFNULL(SUM(CLTCHDRF_TFDISTA),0,SUM(CLTCHDRF_TFDISTA)) as dec(19,5)) AS TFDISTA,
cast(IFNULL(SUM(CELTCHF_TFMSESTB),0,SUM(CELTCHF_TFMSESTB)) as dec(19,5)) AS TFMSESTB,
cast(IFNULL(SUM(CELTCHF_TFNCEDROP),0,SUM(CELTCHF_TFNCEDROP)) as dec(19,5)) AS TFNCEDROP,
cast(IFNULL(SUM(CELTCHF_TFNDROP),0,SUM(CELTCHF_TFNDROP)) as dec(19,5)) AS TFNDROP,
cast(IFNULL(SUM(CELTCHF_TFNDROPSUB),0,SUM(CELTCHF_TFNDROPSUB)) as dec(19,5)) AS TFNDROPSUB,
cast(IFNULL(SUM(CELTCHF_TFNRELCONG),0,SUM(CELTCHF_TFNRELCONG)) as dec(19,5)) AS TFNRELCONG,
cast(IFNULL(SUM(CELTCHF_TFNRELCONGSUB),0,SUM(CELTCHF_TFNRELCONGSUB)) as dec(19,5)) AS TFNRELCONGSUB,
cast(IFNULL(AVG(CELTCHF_TFNSCAN),0,AVG(CELTCHF_TFNSCAN)) as dec(19,5)) AS TFNSCAN,
cast(IFNULL(SUM(CLTCHDRF_TFSUDLOS),0,SUM(CLTCHDRF_TFSUDLOS)) as dec(19,5)) AS TFSUDLOS,
cast(IFNULL(SUM(CLTCHDRF_TFSUDLOSSUB),0,SUM(CLTCHDRF_TFSUDLOSSUB)) as dec(19,5)) AS TFSUDLOSSUB,
cast(IFNULL(SUM(CELTCHF_TFTRALACC),0,SUM(CELTCHF_TFTRALACC)) as dec(19,5)) AS TFTRALACC,
cast(IFNULL(SUM(CELTCHF_TFTRALSUB),0,SUM(CELTCHF_TFTRALSUB)) as dec(19,5)) AS TFTRALSUB,
cast(IFNULL(SUM(CELTCHH_THCASSALL),0,SUM(CELTCHH_THCASSALL)) as dec(19,5)) AS THCASSALL,
cast(IFNULL(SUM(CELTCHH_THCASSALLSUB),0,SUM(CELTCHH_THCASSALLSUB)) as dec(19,5)) AS THCASSALLSUB,
cast(IFNULL(SUM(CLTCHDRH_THDISQABL),0,SUM(CLTCHDRH_THDISQABL)) as dec(19,5)) AS THDISQABL,
cast(IFNULL(SUM(CLTCHDRH_THDISQABLSUB),0,SUM(CLTCHDRH_THDISQABLSUB)) as dec(19,5)) AS THDISQABLSUB,
cast(IFNULL(SUM(CLTCHDRH_THDISQADL),0,SUM(CLTCHDRH_THDISQADL)) as dec(19,5)) AS THDISQADL,
cast(IFNULL(SUM(CLTCHDRH_THDISQADLSUB),0,SUM(CLTCHDRH_THDISQADLSUB)) as dec(19,5)) AS THDISQADLSUB,
cast(IFNULL(SUM(CLTCHDRH_THDISQAUL),0,SUM(CLTCHDRH_THDISQAUL)) as dec(19,5)) AS THDISQAUL,
cast(IFNULL(SUM(CLTCHDRH_THDISQAULSUB),0,SUM(CLTCHDRH_THDISQAULSUB)) as dec(19,5)) AS THDISQAULSUB,
cast(IFNULL(SUM(CLTCHDRH_THDISSBL),0,SUM(CLTCHDRH_THDISSBL)) as dec(19,5)) AS THDISSBL,
cast(IFNULL(SUM(CLTCHDRH_THDISSBLSUB),0,SUM(CLTCHDRH_THDISSBLSUB)) as dec(19,5)) AS THDISSBLSUB,
cast(IFNULL(SUM(CLTCHDRH_THDISSDL),0,SUM(CLTCHDRH_THDISSDL)) as dec(19,5)) AS THDISSDL,
cast(IFNULL(SUM(CLTCHDRH_THDISSDLSUB),0,SUM(CLTCHDRH_THDISSDLSUB)) as dec(19,5)) AS THDISSDLSUB,
cast(IFNULL(SUM(CLTCHDRH_THDISSUL),0,SUM(CLTCHDRH_THDISSUL)) as dec(19,5)) AS THDISSUL,
cast(IFNULL(SUM(CLTCHDRH_THDISSULSUB),0,SUM(CLTCHDRH_THDISSULSUB)) as dec(19,5)) AS THDISSULSUB,
cast(IFNULL(SUM(CLTCHDRH_THDISTA),0,SUM(CLTCHDRH_THDISTA)) as dec(19,5)) AS THDISTA,
cast(IFNULL(SUM(CELTCHH_THMSESTB),0,SUM(CELTCHH_THMSESTB)) as dec(19,5)) AS THMSESTB,
cast(IFNULL(SUM(CELTCHH_THNCEDROP),0,SUM(CELTCHH_THNCEDROP)) as dec(19,5)) AS THNCEDROP,
cast(IFNULL(SUM(CELTCHH_THNDROP),0,SUM(CELTCHH_THNDROP)) as dec(19,5)) AS THNDROP,
cast(IFNULL(SUM(CELTCHH_THNDROPSUB),0,SUM(CELTCHH_THNDROPSUB)) as dec(19,5)) AS THNDROPSUB,
cast(IFNULL(SUM(CELTCHH_THNRELCONG),0,SUM(CELTCHH_THNRELCONG)) as dec(19,5)) AS THNRELCONG,
cast(IFNULL(SUM(CELTCHH_THNRELCONGSUB),0,SUM(CELTCHH_THNRELCONGSUB)) as dec(19,5)) AS THNRELCONGSUB,
cast(IFNULL(AVG(CELTCHH_THNSCAN),0,AVG(CELTCHH_THNSCAN)) as dec(19,5)) AS THNSCAN,
cast(IFNULL(SUM(CLTCHDRH_THSUDLOS),0,SUM(CLTCHDRH_THSUDLOS)) as dec(19,5)) AS THSUDLOS,
cast(IFNULL(SUM(CLTCHDRH_THSUDLOSSUB),0,SUM(CLTCHDRH_THSUDLOSSUB)) as dec(19,5)) AS THSUDLOSSUB,
cast(IFNULL(SUM(CELTCHH_THTRALACC),0,SUM(CELTCHH_THTRALACC)) as dec(19,5)) AS THTRALACC,
cast(IFNULL(SUM(CELTCHH_THTRALSUB),0,SUM(CELTCHH_THTRALSUB)) as dec(19,5)) AS THTRALSUB,
cast(IFNULL(SUM(CLTCH_TNUCHCNT),0,SUM(CLTCH_TNUCHCNT)) as dec(19,5)) AS TNUCHCNT,
cast(IFNULL(SUM(CELLSQI_TSQIACCPT),0,SUM(CELLSQI_TSQIACCPT)) as dec(19,5)) AS TSQIACCPT,
cast(IFNULL(SUM(CELLSQI_TSQIACCPTAF),0,SUM(CELLSQI_TSQIACCPTAF)) as dec(19,5)) AS TSQIACCPTAF,
cast(IFNULL(SUM(CELLSQI_TSQIACCPTAH),0,SUM(CELLSQI_TSQIACCPTAH)) as dec(19,5)) AS TSQIACCPTAH,
cast(IFNULL(SUM(CELLSQI_TSQIACCPTSUB),0,SUM(CELLSQI_TSQIACCPTSUB)) as dec(19,5)) AS TSQIACCPTSUB,
cast(IFNULL(SUM(CELLSQI_TSQIACCPTSUBAF),0,SUM(CELLSQI_TSQIACCPTSUBAF)) as dec(19,5)) AS TSQIACCPTSUBAF,
cast(IFNULL(SUM(CELLSQI_TSQIACCPTSUBAH),0,SUM(CELLSQI_TSQIACCPTSUBAH)) as dec(19,5)) AS TSQIACCPTSUBAH,
cast(IFNULL(SUM(CELLSQI_TSQIBAD),0,SUM(CELLSQI_TSQIBAD)) as dec(19,5)) AS TSQIBAD,
cast(IFNULL(SUM(CELLSQI_TSQIBADAF),0,SUM(CELLSQI_TSQIBADAF)) as dec(19,5)) AS TSQIBADAF,
cast(IFNULL(SUM(CELLSQI_TSQIBADAH),0,SUM(CELLSQI_TSQIBADAH)) as dec(19,5)) AS TSQIBADAH,
cast(IFNULL(SUM(CELLSQI_TSQIBADSUB),0,SUM(CELLSQI_TSQIBADSUB)) as dec(19,5)) AS TSQIBADSUB,
cast(IFNULL(SUM(CELLSQI_TSQIBADSUBAF),0,SUM(CELLSQI_TSQIBADSUBAF)) as dec(19,5)) AS TSQIBADSUBAF,
cast(IFNULL(SUM(CELLSQI_TSQIBADSUBAH),0,SUM(CELLSQI_TSQIBADSUBAH)) as dec(19,5)) AS TSQIBADSUBAH,
cast(IFNULL(SUM(CELLSQI_TSQIGOOD),0,SUM(CELLSQI_TSQIGOOD)) as dec(19,5)) AS TSQIGOOD,
cast(IFNULL(SUM(CELLSQI_TSQIGOODAF),0,SUM(CELLSQI_TSQIGOODAF)) as dec(19,5)) AS TSQIGOODAF,
cast(IFNULL(SUM(CELLSQI_TSQIGOODAH),0,SUM(CELLSQI_TSQIGOODAH)) as dec(19,5)) AS TSQIGOODAH,
cast(IFNULL(SUM(CELLSQI_TSQIGOODSUB),0,SUM(CELLSQI_TSQIGOODSUB)) as dec(19,5)) AS TSQIGOODSUB,
cast(IFNULL(SUM(CELLSQI_TSQIGOODSUBAF),0,SUM(CELLSQI_TSQIGOODSUBAF)) as dec(19,5)) AS TSQIGOODSUBAF,
cast(IFNULL(SUM(CELLSQI_TSQIGOODSUBAH),0,SUM(CELLSQI_TSQIGOODSUBAH)) as dec(19,5)) AS TSQIGOODSUBAH
FROM "dc"."DC_E_BSS_CELL_CS_RAW"
GROUP BY DATE_ID, HOUR_ID, CELL_NAME, BSC) AA

LEFT JOIN
(SELECT DATE_ID, HOUR_ID, CELL_NAME, BSC,
cast(IFNULL(SUM(CELLGPRS_ALLPDCHACC),0,SUM(CELLGPRS_ALLPDCHACC)) as dec(19,5)) AS ALLPDCHACC,
cast(IFNULL(SUM(CELLGPRS_ALLPDCHACTACC),0,SUM(CELLGPRS_ALLPDCHACTACC)) as dec(19,5)) AS ALLPDCHACTACC,
cast(IFNULL(SUM(CELLGPRS_ALLPDCHSCAN),0,SUM(CELLGPRS_ALLPDCHSCAN)) as dec(19,5)) AS ALLPDCHSCAN,
cast(IFNULL(SUM(CELLGPRS_CS12DLACK),0,SUM(CELLGPRS_CS12DLACK)) as dec(19,5)) AS CS12DLACK,
cast(IFNULL(sum(CELLGPRS_CS12DLSCHED),0,sum(CELLGPRS_CS12DLSCHED)) as dec(19,5)) AS CS12DLSCHED,
cast(IFNULL(SUM(CELLGPRS_CS12ULACK),0,SUM(CELLGPRS_CS12ULACK)) as dec(19,5)) AS CS12ULACK,
cast(IFNULL(SUM(CELLGPRS2_CS14DLACK),0,SUM(CELLGPRS2_CS14DLACK)) as dec(19,5)) AS CS14DLACK,
cast(IFNULL(sum(CELLGPRS2_CS14DLSCHED),0,sum(CELLGPRS2_CS14DLSCHED)) as dec(19,5)) AS CS14DLSCHED,
cast(IFNULL(SUM(CCCHLOAD_CSIMMASS),0,SUM(CCCHLOAD_CSIMMASS)) as dec(19,5)) AS CSIMMASS,
cast(IFNULL(SUM(CELLQOSEG_DLBGEGDATA),0,SUM(CELLQOSEG_DLBGEGDATA)) as dec(19,5)) AS DLBGEGDATA,
cast(IFNULL(SUM(CELLQOSEG_DLBGEGPFC),0,SUM(CELLQOSEG_DLBGEGPFC)) as dec(19,5)) AS DLBGEGPFC,
cast(IFNULL(SUM(CELLQOSEG_DLBGEGTHR),0,SUM(CELLQOSEG_DLBGEGTHR)) as dec(19,5)) AS DLBGEGTHR,
cast(IFNULL(SUM(CELLQOSG_DLBGGDATA),0,SUM(CELLQOSG_DLBGGDATA)) as dec(19,5)) AS DLBGGDATA,
cast(IFNULL(SUM(cellqosg_dlbggpfc),0,SUM(cellqosg_dlbggpfc)) as dec(19,5)) AS DLBGGPFC,
cast(IFNULL(SUM(CELLQOSG_DLBGGTHR),0,SUM(CELLQOSG_DLBGGTHR)) as dec(19,5)) AS DLBGGTHR,
cast(IFNULL(SUM(CELLGPRS_DLTBFEST),0,SUM(CELLGPRS_DLTBFEST)) as dec(19,5)) AS DLTBFEST,
cast(IFNULL(SUM(CELLQOSEG_DLTHP1EGDATA),0,SUM(CELLQOSEG_DLTHP1EGDATA)) as dec(19,5)) AS DLTHP1EGDATA,
cast(IFNULL(SUM(CELLQOSEG_DLTHP1EGTHR),0,SUM(CELLQOSEG_DLTHP1EGTHR)) as dec(19,5)) AS DLTHP1EGTHR,
cast(IFNULL(SUM(CELLQOSG_DLTHP1GDATA),0,SUM(CELLQOSG_DLTHP1GDATA)) as dec(19,5)) AS DLTHP1GDATA,
cast(IFNULL(SUM(CELLQOSG_DLTHP1GTHR),0,SUM(CELLQOSG_DLTHP1GTHR)) as dec(19,5)) AS DLTHP1GTHR,
cast(IFNULL(SUM(CELLQOSEG_DLTHP2EGDATA),0,SUM(CELLQOSEG_DLTHP2EGDATA)) as dec(19,5)) AS DLTHP2EGDATA,
cast(IFNULL(SUM(CELLQOSEG_DLTHP2EGTHR),0,SUM(CELLQOSEG_DLTHP2EGTHR)) as dec(19,5)) AS DLTHP2EGTHR,
cast(IFNULL(SUM(CELLQOSG_DLTHP2GDATA),0,SUM(CELLQOSG_DLTHP2GDATA)) as dec(19,5)) AS DLTHP2GDATA,
cast(IFNULL(SUM(CELLQOSG_DLTHP2GTHR),0,SUM(CELLQOSG_DLTHP2GTHR)) as dec(19,5)) AS DLTHP2GTHR,
cast(IFNULL(SUM(CELLQOSEG_DLTHP3EGDATA),0,SUM(CELLQOSEG_DLTHP3EGDATA)) as dec(19,5)) AS DLTHP3EGDATA,
cast(IFNULL(SUM(CELLQOSEG_DLTHP3EGTHR),0,SUM(CELLQOSEG_DLTHP3EGTHR)) as dec(19,5)) AS DLTHP3EGTHR,
cast(IFNULL(SUM(CELLQOSG_DLTHP3GDATA),0,SUM(CELLQOSG_DLTHP3GDATA)) as dec(19,5)) AS DLTHP3GDATA,
cast(IFNULL(SUM(CELLQOSG_DLTHP3GTHR),0,SUM(CELLQOSG_DLTHP3GTHR)) as dec(19,5)) AS DLTHP3GTHR,
cast(IFNULL(SUM(CELLGPRS_FAILDLANSW),0,SUM(CELLGPRS_FAILDLANSW)) as dec(19,5)) AS FAILDLANSW,
cast(IFNULL(SUM(CELLGPRS_FAILDLTBFEST),0,SUM(CELLGPRS_FAILDLTBFEST)) as dec(19,5)) AS FAILDLTBFEST,
cast(IFNULL(SUM(CELLGPRS2_FLUDISC),0,SUM(CELLGPRS2_FLUDISC)) as dec(19,5)) AS FLUDISC,
cast(IFNULL(SUM(CELLGPRS2_IAULREL),0,SUM(CELLGPRS2_IAULREL)) as dec(19,5)) AS IAULREL,
cast(IFNULL(SUM(RLINKBITR_INT10BREGPRSTBF),0,SUM(RLINKBITR_INT10BREGPRSTBF)) as dec(19,5)) AS INT10BREGPRSTBF,
cast(IFNULL(SUM(RLINKBITR_INT10BRGPRSTBF),0,SUM(RLINKBITR_INT10BRGPRSTBF)) as dec(19,5)) AS INT10BRGPRSTBF,
cast(IFNULL(SUM(RLINKBITR_INT12BRGPRSTBF),0,SUM(RLINKBITR_INT12BRGPRSTBF)) as dec(19,5)) AS INT12BRGPRSTBF,
cast(IFNULL(SUM(RLINKBITR_INT14BRGPRSTBF),0,SUM(RLINKBITR_INT14BRGPRSTBF)) as dec(19,5)) AS INT14BRGPRSTBF,
cast(IFNULL(SUM(RLINKBITR_INT15BREGPRSTBF),0,SUM(RLINKBITR_INT15BREGPRSTBF)) as dec(19,5)) AS INT15BREGPRSTBF,
cast(IFNULL(SUM(RLINKBITR_INT16BRGPRSTBF),0,SUM(RLINKBITR_INT16BRGPRSTBF)) as dec(19,5)) AS INT16BRGPRSTBF,
cast(IFNULL(SUM(RLINKBITR_INT18BRGPRSTBF),0,SUM(RLINKBITR_INT18BRGPRSTBF)) as dec(19,5)) AS INT18BRGPRSTBF,
cast(IFNULL(SUM(RLINKBITR_INT20BREGPRSTBF),0,SUM(RLINKBITR_INT20BREGPRSTBF)) as dec(19,5)) AS INT20BREGPRSTBF,
cast(IFNULL(SUM(RLINKBITR_INT25BREGPRSTBF),0,SUM(RLINKBITR_INT25BREGPRSTBF)) as dec(19,5)) AS INT25BREGPRSTBF,
cast(IFNULL(SUM(RLINKBITR_INT30BREGPRSTBF),0,SUM(RLINKBITR_INT30BREGPRSTBF)) as dec(19,5)) AS INT30BREGPRSTBF,
cast(IFNULL(SUM(RLINKBITR_INT35BREGPRSTBF),0,SUM(RLINKBITR_INT35BREGPRSTBF)) as dec(19,5)) AS INT35BREGPRSTBF,
cast(IFNULL(SUM(RLINKBITR_INT40BREGPRSTBF),0,SUM(RLINKBITR_INT40BREGPRSTBF)) as dec(19,5)) AS INT40BREGPRSTBF,
cast(IFNULL(SUM(RLINKBITR_INT45BREGPRSTBF),0,SUM(RLINKBITR_INT45BREGPRSTBF)) as dec(19,5)) AS INT45BREGPRSTBF,
cast(IFNULL(SUM(RLINKBITR_INT50BREGPRSTBF),0,SUM(RLINKBITR_INT50BREGPRSTBF)) as dec(19,5)) AS INT50BREGPRSTBF,
cast(IFNULL(SUM(RLINKBITR_INT55BREGPRSTBF),0,SUM(RLINKBITR_INT55BREGPRSTBF)) as dec(19,5)) AS INT55BREGPRSTBF,
cast(IFNULL(SUM(RLINKBITR_INT8BRGPRSTBF),0,SUM(RLINKBITR_INT8BRGPRSTBF)) as dec(19,5)) AS INT8BRGPRSTBF,
cast(IFNULL(sum(CELLGPRS_LDISEST),0,sum(CELLGPRS_LDISEST)) as dec(19,5)) AS LDISEST,
cast(IFNULL(SUM(CELLGPRS2_LDISOTH),0,SUM(CELLGPRS2_LDISOTH)) as dec(19,5)) AS LDISOTH,
cast(IFNULL(SUM(CELLGPRS2_LDISRR),0,SUM(CELLGPRS2_LDISRR)) as dec(19,5)) AS LDISRR,
cast(IFNULL(SUM(CELLGPRS2_LDISTFI),0,SUM(CELLGPRS2_LDISTFI)) as dec(19,5)) AS LDISTFI,
cast(IFNULL(SUM(CELLGPRS2_MC19DLACK),0,SUM(CELLGPRS2_MC19DLACK)) as dec(19,5)) AS MC19DLACK,
cast(IFNULL(sum(CELLGPRS2_MC19DLSCHED),0,sum(CELLGPRS2_MC19DLSCHED)) as dec(19,5)) AS MC19DLSCHED,
cast(IFNULL(SUM(CELLGPRS_MC19ULACK),0,SUM(CELLGPRS_MC19ULACK)) as dec(19,5)) AS MC19ULACK,
cast(IFNULL(SUM(CELLGPRS_MOVECELLTBF),0,SUM(CELLGPRS_MOVECELLTBF)) as dec(19,5)) AS MOVECELLTBF,
cast(IFNULL(sum(CELLGPRS_MSESTDLTBF),0,sum(CELLGPRS_MSESTDLTBF)) as dec(19,5)) AS MSESTDLTBF,
cast(IFNULL(SUM(CELLGPRS2_MSESTULTBF),0,SUM(CELLGPRS2_MSESTULTBF)) as dec(19,5)) AS MSESTULTBF,
cast(IFNULL(SUM(CELLGPRS2_OTHULREL),0,SUM(CELLGPRS2_OTHULREL)) as dec(19,5)) AS OTHULREL,
cast(IFNULL(SUM(CELLGPRS_PCHALLATT),0,SUM(CELLGPRS_PCHALLATT)) as dec(19,5)) AS PCHALLATT,
cast(IFNULL(SUM(CELLGPRS_PCHALLFAIL),0,SUM(CELLGPRS_PCHALLFAIL)) as dec(19,5)) AS PCHALLFAIL,
cast(IFNULL(SUM(cellgprs_pdrac),0,SUM(cellgprs_pdrac)) as dec(19,5)) AS PDRAC,
cast(IFNULL(SUM(CELLGPRS_PREEMPTPDCH),0,SUM(CELLGPRS_PREEMPTPDCH)) as dec(19,5)) AS PREEMPTPDCH,
cast(IFNULL(SUM(CELLGPRS_PREEMPTTBF),0,SUM(CELLGPRS_PREEMPTTBF)) as dec(19,5)) AS PREEMPTTBF,
cast(IFNULL(SUM(CELLGPRS2_PREEMPTULREL),0,SUM(CELLGPRS2_PREEMPTULREL)) as dec(19,5)) AS PREEMPTULREL,
cast(IFNULL(sum(CELLGPRS3_PREJABISCONG),0,sum(CELLGPRS3_PREJABISCONG)) as dec(19,5)) AS PREJABISCONG,
cast(IFNULL(SUM(CELLGPRS2_PREJOTH),0,SUM(CELLGPRS2_PREJOTH)) as dec(19,5)) AS PREJOTH,
cast(IFNULL(SUM(CELLGPRS2_PREJTFI),0,SUM(CELLGPRS2_PREJTFI)) as dec(19,5)) AS PREJTFI,
cast(IFNULL(SUM(CELLGPRS2_PSCHREQ),0,SUM(CELLGPRS2_PSCHREQ)) as dec(19,5)) AS PSCHREQ,
cast(IFNULL(SUM(CCCHLOAD_PSIMMASS),0,SUM(CCCHLOAD_PSIMMASS)) as dec(19,5)) AS PSIMMASS,
cast(IFNULL(SUM(CCCHLOAD_REJCSIMMASS),0,SUM(CCCHLOAD_REJCSIMMASS)) as dec(19,5)) AS REJCSIMMASS,
cast(IFNULL(SUM(CCCHLOAD_REJPSIMMASS),0,SUM(CCCHLOAD_REJPSIMMASS)) as dec(19,5)) AS REJPSIMMASS,
cast(IFNULL(SUM(TRAFDLGPRS_TBFDLEGPRS),0,SUM(TRAFDLGPRS_TBFDLEGPRS)) as dec(19,5)) AS TBFDLEGPRS,
cast(IFNULL(SUM(TRAFDLGPRS_TBFDLGPRS),0,SUM(TRAFDLGPRS_TBFDLGPRS)) as dec(19,5)) AS TBFDLGPRS,
cast(IFNULL(SUM(CELLQOSEG_ULBGEGDATA),0,SUM(CELLQOSEG_ULBGEGDATA)) as dec(19,5)) AS ULBGEGDATA,
cast(IFNULL(SUM(CELLQOSEG_ULBGEGPFC),0,SUM(CELLQOSEG_ULBGEGPFC)) as dec(19,5)) AS ULBGEGPFC,
cast(IFNULL(SUM(CELLQOSEG_ULBGEGTHR),0,SUM(CELLQOSEG_ULBGEGTHR)) as dec(19,5)) AS ULBGEGTHR,
cast(IFNULL(SUM(CELLQOSG_ULBGGDATA),0,SUM(CELLQOSG_ULBGGDATA)) as dec(19,5)) AS ULBGGDATA,
cast(IFNULL(SUM(cellqosg_ulbggpfc),0,SUM(cellqosg_ulbggpfc)) as dec(19,5)) AS ULBGGPFC,
cast(IFNULL(SUM(CELLQOSG_ULBGGTHR),0,SUM(CELLQOSG_ULBGGTHR)) as dec(19,5)) AS ULBGGTHR,
cast(IFNULL(SUM(CELLQOSEG_ULTHP1EGDATA),0,SUM(CELLQOSEG_ULTHP1EGDATA)) as dec(19,5)) AS ULTHP1EGDATA,
cast(IFNULL(SUM(CELLQOSEG_ULTHP1EGTHR),0,SUM(CELLQOSEG_ULTHP1EGTHR)) as dec(19,5)) AS ULTHP1EGTHR,
cast(IFNULL(SUM(CELLQOSG_ULTHP1GDATA),0,SUM(CELLQOSG_ULTHP1GDATA)) as dec(19,5)) AS ULTHP1GDATA,
cast(IFNULL(SUM(CELLQOSG_ULTHP1GTHR),0,SUM(CELLQOSG_ULTHP1GTHR)) as dec(19,5)) AS ULTHP1GTHR,
cast(IFNULL(SUM(CELLQOSEG_ULTHP2EGDATA),0,SUM(CELLQOSEG_ULTHP2EGDATA)) as dec(19,5)) AS ULTHP2EGDATA,
cast(IFNULL(SUM(CELLQOSEG_ULTHP2EGTHR),0,SUM(CELLQOSEG_ULTHP2EGTHR)) as dec(19,5)) AS ULTHP2EGTHR,
cast(IFNULL(SUM(CELLQOSG_ULTHP2GDATA),0,SUM(CELLQOSG_ULTHP2GDATA)) as dec(19,5)) AS ULTHP2GDATA,
cast(IFNULL(SUM(CELLQOSG_ULTHP2GTHR),0,SUM(CELLQOSG_ULTHP2GTHR)) as dec(19,5)) AS ULTHP2GTHR,
cast(IFNULL(SUM(CELLQOSEG_ULTHP3EGDATA),0,SUM(CELLQOSEG_ULTHP3EGDATA)) as dec(19,5)) AS ULTHP3EGDATA,
cast(IFNULL(SUM(CELLQOSEG_ULTHP3EGTHR),0,SUM(CELLQOSEG_ULTHP3EGTHR)) as dec(19,5)) AS ULTHP3EGTHR,
cast(IFNULL(SUM(CELLQOSG_ULTHP3GDATA),0,SUM(CELLQOSG_ULTHP3GDATA)) as dec(19,5)) AS ULTHP3GDATA,
cast(IFNULL(SUM(CELLQOSG_ULTHP3GTHR),0,SUM(CELLQOSG_ULTHP3GTHR)) as dec(19,5)) AS ULTHP3GTHR

FROM "dc"."DC_E_BSS_CELL_PS_RAW"
GROUP BY DATE_ID, HOUR_ID, CELL_NAME,BSC) AB
ON AA.DATE_ID = AB.DATE_ID
AND AA.CELL_NAME = AB.CELL_NAME
AND AA.BSC = AB.BSC
AND AA.HOUR_ID = AB.HOUR_ID

LEFT JOIN
(SELECT DATE_ID, HOUR_ID, CELL_NAME, BSC,
cast(IFNULL(sum(HOVERCNT),0,sum(HOVERCNT)) as dec(19,5)) as SUMEOHATT,
cast(IFNULL(sum(HOVERSUC),0,sum(HOVERSUC)) as dec(19,5)) as SUMEOHSUCC,
cast(IFNULL(sum(HOVERCNT),0,sum(HOVERCNT)) as dec(19,5)) as SUMOHOATT,
cast(IFNULL(sum(HOVERSUC),0,sum(HOVERSUC)) as dec(19,5)) as SUMOHOSUCC,
cast(IFNULL(sum(HORTTOCH),0,sum(HORTTOCH)) as dec(19,5)) as SUMOHOREV,
cast(IFNULL((SUM(HOVERCNT)-SUM(HOVERSUC)-SUM(HORTTOCH)),0,(SUM(HOVERCNT)-SUM(HOVERSUC)-SUM(HORTTOCH))) as dec(19,5)) AS SUMOHOLOST

FROM "dc"."DC_E_BSS_CELL_ADJ_RAW"
GROUP BY DATE_ID, HOUR_ID, CELL_NAME,BSC) AC
ON AA.DATE_ID = AC.DATE_ID
AND AA.CELL_NAME = AC.CELL_NAME
AND AA.BSC = AC.BSC
AND AA.HOUR_ID = AC.HOUR_ID


LEFT JOIN
(SELECT DATE_ID, HOUR_ID, CELL_NAME, BSC,
cast(IFNULL(SUM(CELTCHFV_TFTRALACCV),0,SUM(CELTCHFV_TFTRALACCV)) as dec(19,5)) AS TFTRALACCV,
cast(IFNULL(SUM(CELTCHHV_THTRALACCV),0,SUM(CELTCHHV_THTRALACCV)) as dec(19,5)) AS THTRALACCV,
cast(IFNULL(SUM(CLTCHFV5_TFV5TRALACC),0,SUM(CLTCHFV5_TFV5TRALACC)) as dec(19,5)) AS TFV5TRALACC

FROM "dc"."DC_E_BSS_CELL3_RAW"
GROUP BY DATE_ID, HOUR_ID, CELL_NAME, BSC) AD
ON AA.DATE_ID = AD.DATE_ID
AND AA.CELL_NAME = AD.CELL_NAME
AND AA.BSC = AD.BSC
AND AA.HOUR_ID = AD.HOUR_ID

LEFT JOIN
(SELECT DATE_ID, HOUR_ID, CELL_NAME, BSC
,ISNULL(sum(HOVERCNTUTRAN),0) as HOVERCNTUTRAN_
,ISNULL(sum(HOVERSUCUTRAN),0) as HOVERSUCUTRAN_
,ISNULL(sum(HORTTOCHUTRAN),0) as HORTTOCHUTRAN_
FROM "dc"."DC_E_BSS_CELL_UTRAN_ADJ_RAW"
GROUP BY DATE_ID, HOUR_ID, CELL_NAME, BSC) AF
ON AA.DATE_ID = AF.DATE_ID
AND AA.CELL_NAME = AF.CELL_NAME
AND AA.BSC = AF.BSC
AND AA.HOUR_ID = AF.HOUR_ID

WHERE
AA.HOUR_ID IN (11, 12, 13, 14) AND
AA.DATE_ID IN ('2024-26-2', '2024-11-3') AND (
AA.BSC like 'BSC1' or
AA.BSC like '1BSC1'
)

ORDER BY AA.DATE_ID, AA.BSC, AA.CELL_NAME;
